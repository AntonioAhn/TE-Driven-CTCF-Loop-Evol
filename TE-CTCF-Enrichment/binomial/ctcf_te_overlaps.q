CREATE TABLE ctcf_repeats ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t' STORED AS RCFile AS SELECT rp.id AS `id_rp`, rp.chrom AS `chrom`, rp.chromStart as `chromStart_rp`, rp.chromEnd AS `chromEnd_rp`, rp.name AS `name_rp`, rp.class AS `class_rp`, rp.family AS `family_rp`, rp.pctdiv AS `pctdiv_rp`, cs.id AS `id_ctcf`, cs.chromstart AS `chromStart_ctcf`, cs.chromEnd AS `chromEnd_ctcf`, cs.signalValue AS `signalValue_ctcf`, cs.peak AS `peak_ctcf`, cs.factor AS `factor`, cs.species AS `species`, cs.cell AS `cell` FROM repeatmasker rp INNER JOIN chip_seq cs ON (cs.species = rp.species) WHERE cs.factor='CTCF' AND cs.chrom = rp.chrom AND cs.peak BETWEEN rp.chromStart AND rp.chromEnd;
INSERT OVERWRITE DIRECTORY '/user/adadiehl/ctcf_te_enrichment' ROW FORMAT DELIMITED FIELDS TERMINATED BY'\t' STORED AS TEXTFILE SELECT * FROM ctcf_repeats;
